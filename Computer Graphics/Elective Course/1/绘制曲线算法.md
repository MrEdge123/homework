# 绘制曲线算法

## $y=ax^2+bx+c$

### 大致思路

1. 首先判断a是否等于0。如果为0，就用Bresenham算法，否则进入下一步
2. 对于a大于0的情况，就转化为a小于0的情况，画点的时候对称回去
3. 考虑生成二次函数的右半部分，左半部分可以通过右半部分对称获得
4. 想办法得到临界点：对$y=ax^2+bx+c$求导，得：$y'=2ax+b$。令：$y'=1$，得：$x=\frac{1-b}{2a}$
5. 对于$x \in [0, \frac{1-b}{2a})$，沿着$x$坐标递增。每一次$x$坐标递增1个单位时，确定$y$坐标是否递增1个单位。
6. 对于$x \in [\frac{1-b}{2a}, x_{max}]$，沿着$y$坐标递增。每一次$y$坐标递增1个单位时，确定$x$坐标是否递增1个单位。

### 误差量分析

1.$x \in [0, \frac{1-b}{2a})$的情况：

构造函数：$F(x,y)=y-(ax^2+bx+c)$
对于在曲线上的点，$F(x,y)=0$；对于曲线以下的点，$F(x,y)<0$；对于曲线以上的点，$F(x,y)>0$

当前像素点：$(x_p,y_p)$，中点：$(x_p+1,y_p-0.5)$
判别式：$d_p=F(x_p+1,y_p-0.5)=y_p-0.5-(a(x_p+1)^2+b(x_p+1)+c)$

若$d_p<0$，说明中点在曲线下面，则取像素：$(x_p+1, y_p)$
判别式更新：$d_{p+1}=F(x_p+2,y_p-0.5)=y_p-0.5-(a(x_p+2)^2+b(x_p+2)+c)=d_p-(2ax_p+3a+b)$
增量：$-2ax_p-(3a+b)$

若$d_p>0$，说明中点在曲线上面，则取像素：$(x_p+1,y_p-1)$
判别式更新：$d_{p+1}=F(x_p+2,y_p-1.5)=y_p-1.5-(a(x_p+2)^2+b(x_p+2)+c)=d_p-(2ax_p+3a+b+1)$
增量：$-2ax_p-(3a+b+1)$

2.$x \in [\frac{1-b}{2a}, x_{max}]$的情况：

构造函数同上，方法与上面类似，就是改为以$y$坐标为步长进行计算。

## $ax^2+bxy+cy^2+dx+ey+f=0$

### 思路

在方程两边对$y$进行求导，得：
$2ax+b(y+xy')+2cyy'+d+ey'=0$

当$y'=1$时，方程为：$(2a+b)x+(2c+b)y+d+e=0$
当$y'=-1$时，方程为：$(2a-b)x-(2c-b)y+d-e=0$

所以得到两个临界条件：
$(2a+b)x+(2c+b)y+d+e=0$
$(2a-b)x-(2c-b)y+d-e=0$

在临界条件构成的区间内，如果区间上的点的导数的绝对值小于1，就以$x$坐标为步长；如果区间上的点的导数的绝对值大于1，就以$y$坐标为步长。
